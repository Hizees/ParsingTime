\Section{repr}{Representation}
We define a compositional representation of tiem; a type system 
	is described in \refsec{repr-types} while the grammar is outlined in
	\refsec{repr-compositional} and described in detail in 
	\refsecs{repr-lexicon}{repr-rules}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TEMPORAL EXPRESSIONS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Subsection{repr-types}{Temporal Expression Types}
% -- Intro to Types
We represent temporal expressions as either a \ty{Range}, \ty{Sequence},
	or \ty{Duration}.
We describe these, the \ty{Function} type, and the miscellaneous
	\ty{Number} and \ty{Nil} types below:
% -- Range
\paragraph{Range}
%(definition)
A period between two dates (or times).
%(examples)
This includes entities such as \te{Today}, \te{1987}, or
	\te{Now}.
We denote a range by the variable \range.
We maintain a consistent interval-based theory of time
	\cite{key:1981allen-temporal} and represent instances as intervals with
	zero span.

% -- Sequence 
\paragraph{Sequence}
%(definition)
A sequence of \ty{Range}s, not necessarily occurring at regular intervals.
%(examples)
This includes entities such as \te{Friday}, \te{November \th{27}}, or
	\te{last Friday}.
%(anatomy)
A \ty{Sequence} is a tuple of three elements
	$\seq=(\seqelem,\seqjump,\seqcanon)$:
\begin{enumerate}
	\setlength{\itemsep}{-5pt} 
	\item $\seqelem(i)$: 
		The \th{i} interval of a sequence.
		In the case of the sequence \te{Friday}, $\seqelem(0)$ corresponds to
			\tp{the Friday in the current week}; 
			$\seqelem(1)$ is the Friday in the following week, \textit{et cetera}.
	\item \seqjump:
		The \textit{distance} between two elements in the sequence -- approximated
			if this distance is not constant.
		In the case of \te{Friday}, this distance would be a \te{Week}.
	\item \seqcanon:
		The \textit{containing unit} of an element of a sequence.
		For example, \seqcanonX{Friday} would be the \ty{Range}
			corresponding to \tp{the current week}.
		The sequence index $i \in \BZ$ is defined relative to $\seqelem(0)$ --
			the element in the same containing unit as the reference time.
\end{enumerate}

%(definition of reference time)
We define the \textit{reference time} $t$ \cite{key:1947reichenback-temporal}
	to be the instant when the phrase 
	is uttered; for the \tempeval\ corpus, we approximate this as the
	publication time of the article.

%(sequence as distribution)
To contrast with \ty{Range}s, a \ty{Sequence} can represent a number of specific
	times.
Nonetheless, pragmatically, not all of these are given equal weight --
	an utterance of \tp{last Friday} may mean either of the previous two Fridays,
	but is unlikely to ground to anything else.
We represent this ambiguity by defining a distribution over the elements
	of the \ty{Sequence}.
Particularly, we define a Gaussian -- conditioned on $t$ -- with mean and
	variance defined according to the distance \seqjump.
The input to the Gaussian is a function $\delta_{s,t}$:
	the distance between the reference time and the element in question:
\reffig{distribution} shows an example of such a distribution.
% -- Gaussian Plot
\begin{figure}[t]
\begin{center}
	\resizebox{1.1\hsize}{!}{
		\input fig/gauss.tex
	}
	\caption{
		\label{fig:distribution}
		An illustration of a temporal distribution, e.g., \te{Sunday}.
		The reference time is labeled as time $t$ between \te{Nov 20} and 
			\te{Nov 27}; the probability that this sequence is referring to
			\te{Nov 20} is integral of the marked area.
		Note that shifting the reference time towards \te{Nov 20} would increase
			this probability.
	}
\end{center}
\end{figure}
% -- Gaussian Equation
\begin{equation}
\label{eqn:gaussian}
	P_t(i) = 
	\int_{i-0.5}^{i+0.5}
		\textrm{Norm}\left(\frac{\delta_{s,t}(i)-\delta_{s,t}(0)}{\seqjump}\right)
\end{equation}

%(global scope)
The parameters $\mu$ and $\sigma$ in Equation \refeqn{gaussian} are shared
	among all sequence instances; the normalization
	with respect to \seqjump\ ensures that the distribution is applicable
	to any particular sequence.
	
% -- Duration
\paragraph{Duration}
%(definition)
A period of time.
%(examples)
This includes entities like \te{Week}, \te{Month}, and \te{7 days}.
%(etc.)
We denote a duration with the variable \dur.

%(fuzzy)
We define a special case of the \ty{Duration} type to represent 
	\textit{approximate} durations.
These are used to represent expressions such as \tp{a few years} or
	\tp{some days}.
Semantically, they are equivalent to any other approximate
	duration with the same unit and distinct from any other \ty{Duration}.

% -- Functions
\paragraph{Function}
%(definition)
A function of arity less than or equal to two representing some
	general modification to one of the above types.
%(examples)
This captures semantic entities such as those implied in
	\tp{last $x$}, \tp{the third $x$ [of $y$]}, or \tp{$x$ days ago}.
%(etc.)
The particular functions and their application are discussed in 
	\reftab{function}.


% -- Other
\paragraph{Other Types}
Two other types bear auxiliary roles in representing temporal expressions,
	though they are not directly temporal concepts.
In the grammar, these appear as preterminals only.

The first of these types is \ty{Number} -- denoting a number without
	any temporal meaning attached.
This comes into play representing expressions such as \tp{2 weeks}.
The other is the \ty{Nil} type -- denoting terms which are not
	directly contributing to the semantic meaning of the expression.
This is intended for words such as \tp{a} or \tp{the}, which serve as cues
	without bearing temporal content themselves.
The \ty{Nil} type is lexicalized with the word it generates.


\paragraph{Omitted Phenomena}
The representation described is a simplification of the complexities of
	time.
Notably, a body of work has focused on reasoning about events or states
	relative to temporal expressions -- 
	\newcite{key:1988moens-temporal} describes temporal expressions relating to
	changes of state; 
	\newcite{key:2010condoravdi-temporal} explores NPI licensing in temporal
	expressions.
Furthermore, vague times (e.g. \tp{in the 90's})represent a notable chunk of 
	temporal expressions uttered.
In contrast, NLP evaluations have generally not included such vague 
	time expressions.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TIME AS COMPOSITIONAL PARSING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Subsection{repr-compositional}{Synchronous PCFG}
% -- Time is compositional
Our approach builds on the assumption that the natural language description
	of time is compositional in nature.
Unlike many aspects of language  -- which are often not compositional or
	idiomatic -- each word attached to a temporal phrase is 
	usually compositionally modifying the meaning of the phrase.
To demonstrate, we consider the expression \tp{last Friday the \th{13}}.
Decomposing the example, we can construct a meaning by 
	applying the modifiers \tp{last} to \tp{Friday} -- 
	creating the previous \te{Friday};
	and \tp{the \th{13}} -- creating the previous \te{Friday} that is
	also the \th{13} of the month.

% -- Synchronous Grammar
\Fig{fig/grammar}{0.45}{grammar}{
	The synchronous grammar -- (a) describes the CFG parse of the
		temporal \textit{types}; (b) describes the corresponding combination
		of the temporal \textit{instances}.
	The parse in (b) is deterministic given the grammar combination rules
		in (a).
}
%(introduction)
We construct a paradigm for parsing temporal phrases based on a Synchronous
	PCFG defined over the temporal \textit{instances} and their
	corresponding \textit{types}, similar in some respects but more
	constrained than those used in machine translation 
	(e.g., \newcite{key:2001yamada-syntaxmt}).
This is in contrast to common approaches, such CCG 
	grammars 
	\cite{key:2000steedman-ccg,key:2004bos-ccg,2011kwiatkowski-semantics},
	giving us more flexibility in the composition rules.
\reffig{grammar} shows an example of the grammar.

%(formal definition)
Formally, we define a Synchronous PCFG 
	$G = \left(\Sigma,S,\sV,\sW,\sR,\theta\right)$.
The alphabet $\Sigma$ and start symbol $S$ retain their usual interpretations.

%(nonterminals)
We define a set $\sV$ to be the set of types as described in
	\refsec{repr-types} -- these act as our nonterminals.
For each $v \in \sV$ we define an (unbounded) set $W_v$ corresponding to the 
	possible instances of type $v$.
Concretely, if $v=\ty{Sequence}$, our set $W_v \in \sW$ could contain elements
	corresponding to \tp{Friday}, \tp{last Friday}, \tp{Nov. \th{27}},
	\textit{et cetera}.
The synchronous grammar is constructed over pairs $(v,w \in W_v)$.

%(rules)
A rule $R \in \sR$ is defined as a pair 
	$R = \left(v_i \rightarrow v_jv_k, 
		f : (W_{v_j},W_{v_k}) \rightarrow W_{v_i}\right)$
The first term is a conventional PCFG rule over the types
	$\sV$.
In a conventional synchronous PCFG, the second term would be the corresponding
	combination rule over our nonterminals $\sW$.
In our case, this term is a deterministic function mapping the
	constituent expressions to the parent expression.
That is, we are learning a rule-to-rule translation 
	\cite{key:1976bach-semantics}.
%This both handles the unbounded domain of temporal expressions,
%	as well as constrains the formalism.
Note that the definition above is trivially adapted for the case of unary
	rules.

%(probabilities)
The last term in our grammar formalism denotes the rule probabilities $\theta$.
In line with the usual interpretation, this defines a probability
	of applying a particular rule $r \in R$.
Importantly, note that the distribution over possible groundings
	of a temporal expression are not included in the grammar
	formalism.
The learning of these probabilities is detailed in \refsec{learn}.

%%(motivation)
%We defined a paradigm for expressing how natural language composes
%	temporal phrases while accounting for the sparsity inherent in composing
%	individual expressions -- as well as helping ensure that the resulting
%	expressions are semantically valid.
%In parallel, a particular temporal expression is parsed, which can then
%	be grounded by a reference time to provide the final temporal expression.
%We continue to describe the preterminals of our grammar and the introduction
%	of our synchronous terms.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% LEXICON
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Subsection{repr-lexicon}{Preterminals}
% -- Static Lexicon
\begin{table}[tb]
	\begin{center}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Type} & \textbf{Instances} \\
		\hline
		\hline
		% -- Ranges
		\ty{Range} &
			\te{Past}, \te{Future}, \te{Yesterday}, \\
			& \te{Tomorrow}, \te{Today}, \te{Reference}, \\
			& \te{Year($n$)}, \te{Century($n$)} \\
		\hline
		% -- Sequences
		\ty{Sequence} 
			%(named sequences)
			& \te{Friday}, \te{January}, $\dots$ \\
			& \te{DayOfMonth}, \te{DayOfWeek}, $\dots$ \\
			& \te{EveryDay}, \te{EveryWeek}, $\dots$ \\
%			& \te{Morning}, \te{Afternoon}, $\dots$ \\
%			& \te{Monday}, \te{Tuesday}, $\dots$ \\
%			& \te{January}, \te{February}, $\dots$ \\
%			& \te{Winter}, \te{Spring}, $\dots$ \\
%			%(from number)
%			& \te{MinuteOfHour($0 \dots 59$)}, \\
%			& \te{HourOfDay($0 \dots 23$)}, \\
%			& \te{DayOfMonth($1 \dots 31$)}, \\
%			& \te{MonthOfYear($1 \dots 12$)}, \\
%			& \te{YearOfCentury($0 \dots 99$)}, \\
%			& \te{DecadeOfCentury($0 \dots 9$)}, \\
%			& \te{YearOfDecade($0 \dots 9$)}, \\
%			%(durational)
%			& \te{EveryDay}, \te{EveryWeek}, \\
%			& \te{EveryMonth}, \te{EveryQuarter}, \\
%			& \te{EverySeason} \\
		\hline
		% -- Durations
		\ty{Duration}
			& \te{Second}, \te{Minute}, \te{Hour}, \\
			& \te{Day}, \te{Week}, \te{Month}, \te{Quarter}, \\
			& \te{Year}, \te{Decade}, \te{Century} \\
		\hline
	\end{tabular}
	\caption{
		The content-bearing preterminals of the grammar, arranged by their
			types.
		Note that the \ty{Sequence} type contains significantly more elements
			than enumerated here; however, these are condensed for the sake of
			brevity.
	}
	\label{tab:content}
	\end{center}
\end{table}

% -- Function Lexicon
\begin{table*}[t]
	\begin{center}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Function} & \textbf{Description} & \textbf{Signature(s)} \\
		\hline
		\hline
		% -- Arity 2
		%(shift left)
		\texttt{shiftLeft}
			& Shift a \ty{Range} or \ty{Sequence} left by a \ty{Duration}
			& $f : \ty{S},\ty{D} \rightarrow \ty{S}$; ~~
			  $f : \ty{R},\ty{D} \rightarrow \ty{R}$ \\
		\texttt{shiftRight}
			& Shift a \ty{Range} or \ty{Sequence} right by a \ty{Duration}
			& $f : \ty{S},\ty{D} \rightarrow \ty{S}$; ~~
			  $f : \ty{R},\ty{D} \rightarrow \ty{R}$ \\
		\hline
		%(shrink begin)
		\texttt{shrinkBegin}
			& Take the first \ty{Duration} of a \ty{Range}/\ty{Sequence}
			& $f : \ty{S},\ty{D} \rightarrow \ty{S}$; ~~
			  $f : \ty{R},\ty{D} \rightarrow \ty{R}$ \\
		\texttt{shrinkEnd}
			& Take the last \ty{Duration} of a \ty{Range}/\ty{Sequence}
			& $f : \ty{S},\ty{D} \rightarrow \ty{S}$; ~~
			  $f : \ty{R},\ty{D} \rightarrow \ty{R}$ \\
		\hline
		\texttt{catLeft}
			& Take \ty{Duration} units after the end of a \ty{Range}
			& $f : \ty{R},\ty{D} \rightarrow \ty{R}$ \\
		\texttt{catRight}
			& Take \ty{Duration} units before the start of a \ty{Range}
			& $f : \ty{R},\ty{D} \rightarrow \ty{R}$ \\
		\hline
		% -- Arity 1
		%(seq move)
		\texttt{moveLeft1}
			& Move the origin of a \ty{sequence} left by 1
			& $f : \ty{S} \rightarrow \ty{S}$ \\
		\texttt{moveRight1}
			& Move the origin of a sequence right by 1
			& $f : \ty{S} \rightarrow \ty{S}$ \\
		\hline
		%(n^th element)
		\texttt{\th{$n$} $x$ of $y$}
			& Take the \th{$n$} \ty{Sequence} in $y$ (Day of Week, \textit{etc})
			& $f : \ty{Number} \rightarrow \ty{S}$ \\
		\hline
		%(fuzzify)
		\texttt{approximate}
			& Make a \ty{Duration} approximate
			& $f : \ty{D} \rightarrow \ty{D}$ \\
		\hline
	\end{tabular}
	\caption{
		The functional preterminals of the grammar; \ty{R}, \ty{S}, and \ty{D}
			denote \ty{Range}s \ty{Sequence}s and \ty{Duration}s respectively.
		The name, a brief description, and the type signature of the function
			(as used in parsing) are given.
		Described in more detail in \refsec{repr-rules}, the functions generally 
			apply generic interval or sequence modifications.
	}
	\label{tab:function}
	\end{center}
\end{table*}

% -- Intro
We define a set of preterminals, consisting of pairs of 
	\textit{types} and \textit{instances}	of temporal expressions.
A distinction is made in our description between entities with 
	content roles versus entities with a functional role.

% -- Content
The first -- consisting of \ty{Range}s, \ty{Sequence}s, and \ty{Duration}s --
	are listed in \reftab{content}.
A total of 57 such preterminals are defined in the implemented system,
	although this list is easily adaptable to fit specialized domains.
It should be noted that, although the expressions are described textually,
	their meaning is purely semantic, and any association with their 
	textual realization must be learned.
Furthermore, entities which are subject to interpretation -- for example
	\te{Quarter} or \te{Season} -- are given a concrete interpretation.
The \th{$n$} quarter is defined by evenly splitting a year into four;
	the seasons are defined in the same way but with winter beginning in December.

% -- Functional
The functional entities are described in \reftab{function}, and correspond to
	the \ty{Function} type.
The majority of these mirror generic operations on intervals on a timeline,
	or manipulations of a sequence.
Notably, like intervals, times can be moved (\tp{3 weeks ago}) or
	their size changed (\tp{the first two days of the month}), or
	a new interval can be started from one of the endpoints
	(\tp{the last 2 days}).
Additionally, a sequence can be modified by shifting its origin
	(\tp{last Friday}), 
	or taking the \th{$n$} element of the sequence within some bound
	(\tp{fourth Sunday in November}).

% -- Other
The lexical entries for the \ty{Nil} and \ty{Number} types are straightforward,
	though they play an important role in parsing, as described later.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% RULES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Subsection{repr-rules}{Combination Rules}
% -- Intro
The synchronous PCFG grammar consists of a standard CFG rule over temporal
	types (in $\sV$) paired with a deterministic procedure for combining instances
	of those types (in $W_v \in \sW$).
This procedure can be summarized as function application: 
applying (or partially applying) a function with one of its
		arguments.
A separate rule exists for applying on the left versus on the right --
that is, for composing $f(x,y) \odot x$ versus $x \odot f(x,y)$.

% -- Special Cases
Three functions are defined in addition to those in \reftab{function};
	these are unique in that they can be applied without needing explicit 
	support from the text:

% -- Operators
\begin{itemize}
	%(intersection)
	\item Intersecting two ranges or sequences.
		This roughly equates to applying a special \textit{intersect} function
			without requiring that it be explicit in the temporal phrase.
		The intersect function treats both arguments as intervals, and will return
			the overlap between the intervals\footnote{
				In the case of sequences (e.g., \te{\th{13}} intersect \te{May}) a
					search is performed to find overlapping ranges in the two sequences;
					the origin is updated to refer to the closest such
					match to the reference time.
				In cases where this search cannot be solved analytically
					(e.g., \te{\th{13}} intersect \te{Friday}), an A$^{*}$
					search is used to find an overlapping pair of ranges
					in time logarithmic with respect to
					the distance in milliseconds to the match.
		}.
	%(mult)
	\item Multiplying a \ty{Number} with a \ty{Duration}.
	%(nil)
	\item Combining a non-\ty{Nil} and \ty{Nil} elements with no change to the
			temporal expression.
		The lexicalization of the \ty{Nil} type allows the algorithm
			to take hints from these supporting words.
\end{itemize}

% -- Segue
We proceed to describe learning the parameters of this grammar.

